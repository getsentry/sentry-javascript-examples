[
  {
    "event_id": "[[ID1]]",
    "sent_at": "[[ISODateString]]",
    "sdk": {
      "name": "sentry.javascript.node",
      "version": "8.0.0-alpha.9"
    },
    "dsn": "[[dsn]]"
  },
  {
    "type": "event"
  },
  {
    "exception": {
      "values": [
        {
          "type": "Error",
          "value": "Local Variable Error",
          "stacktrace": {
            "frames": [
              {
                "filename": "[[FILENAME1]]",
                "module": "@opentelemetry.instrumentation-express.build.src:instrumentation",
                "function": "arguments.<computed>",
                "lineno": 210,
                "colno": 41,
                "in_app": false,
                "pre_context": [
                  "                            (_a = req.res) === null || _a === void 0 ? void 0 : _a.removeListener('finish', onResponseFinish);",
                  "                            span.end();",
                  "                        }",
                  "                        if (!(req.route && isError)) {",
                  "                            req[internal_types_1._LAYERS_STORE_PROPERTY].pop();",
                  "                        }",
                  "                        const callback = args[callbackIdx];"
                ],
                "context_line": "                        return callback.apply(this, arguments);",
                "post_context": [
                  "                    };",
                  "                }",
                  "                try {",
                  "                    return original.apply(this, arguments);",
                  "                }",
                  "                catch (anyError) {",
                  "                    const [error, message] = (0, utils_1.asErrorAndMessage)(anyError);"
                ]
              },
              {
                "filename": "[[FILENAME2]]",
                "module": "express.lib.router:index",
                "function": "next",
                "lineno": 280,
                "colno": 10,
                "in_app": false,
                "pre_context": [
                  "    // Capture one-time layer values",
                  "    req.params = self.mergeParams",
                  "      ? mergeParams(layer.params, parentParams)",
                  "      : layer.params;",
                  "    var layerPath = layer.path;",
                  "",
                  "    // this should be done for the layer"
                ],
                "context_line": "    self.process_params(layer, paramcalled, req, res, function (err) {",
                "post_context": [
                  "      if (err) {",
                  "        next(layerError || err)",
                  "      } else if (route) {",
                  "        layer.handle_request(req, res, next)",
                  "      } else {",
                  "        trim_prefix(layer, layerError, layerPath, path)",
                  "      }"
                ]
              },
              {
                "filename": "[[FILENAME2]]",
                "module": "express.lib.router:index",
                "function": "Function.process_params",
                "lineno": 346,
                "colno": 12,
                "in_app": false,
                "pre_context": [
                  "  var params = this.params;",
                  "",
                  "  // captured parameters from the layer, keys and values",
                  "  var keys = layer.keys;",
                  "",
                  "  // fast track",
                  "  if (!keys || keys.length === 0) {"
                ],
                "context_line": "    return done();",
                "post_context": [
                  "  }",
                  "",
                  "  var i = 0;",
                  "  var name;",
                  "  var paramIndex = 0;",
                  "  var key;",
                  "  var paramVal;"
                ]
              },
              {
                "filename": "[[FILENAME2]]",
                "module": "express.lib.router:index",
                "function": "?",
                "lineno": 284,
                "colno": 15,
                "in_app": false,
                "pre_context": [
                  "    var layerPath = layer.path;",
                  "",
                  "    // this should be done for the layer",
                  "    self.process_params(layer, paramcalled, req, res, function (err) {",
                  "      if (err) {",
                  "        next(layerError || err)",
                  "      } else if (route) {"
                ],
                "context_line": "        layer.handle_request(req, res, next)",
                "post_context": [
                  "      } else {",
                  "        trim_prefix(layer, layerError, layerPath, path)",
                  "      }",
                  "",
                  "      sync = 0",
                  "    });",
                  "  }"
                ]
              },
              {
                "filename": "[[FILENAME3]]",
                "module": "express.lib.router:layer",
                "function": "Layer.handle [as handle_request]",
                "lineno": 95,
                "colno": 5,
                "in_app": false,
                "pre_context": [
                  "",
                  "  if (fn.length > 3) {",
                  "    // not a standard request handler",
                  "    return next();",
                  "  }",
                  "",
                  "  try {"
                ],
                "context_line": "    fn(req, res, next);",
                "post_context": [
                  "  } catch (err) {",
                  "    next(err);",
                  "  }",
                  "};",
                  "",
                  "/**",
                  " * Check if this route matches `path`, if so"
                ]
              },
              {
                "filename": "[[FILENAME1]]",
                "module": "@opentelemetry.instrumentation-express.build.src:instrumentation",
                "function": "?",
                "lineno": 214,
                "colno": 37,
                "in_app": false,
                "pre_context": [
                  "                            req[internal_types_1._LAYERS_STORE_PROPERTY].pop();",
                  "                        }",
                  "                        const callback = args[callbackIdx];",
                  "                        return callback.apply(this, arguments);",
                  "                    };",
                  "                }",
                  "                try {"
                ],
                "context_line": "                    return original.apply(this, arguments);",
                "post_context": [
                  "                }",
                  "                catch (anyError) {",
                  "                    const [error, message] = (0, utils_1.asErrorAndMessage)(anyError);",
                  "                    span.recordException(error);",
                  "                    span.setStatus({",
                  "                        code: api_1.SpanStatusCode.ERROR,",
                  "                        message,"
                ]
              },
              {
                "filename": "[[FILENAME4]]",
                "module": "express.lib.router:route",
                "function": "Route.dispatch",
                "lineno": 119,
                "colno": 3,
                "in_app": false,
                "pre_context": [
                  "",
                  "  if (method === 'head' && !this.methods['head']) {",
                  "    method = 'get';",
                  "  }",
                  "",
                  "  req.route = this;",
                  ""
                ],
                "context_line": "  next();",
                "post_context": [
                  "",
                  "  function next(err) {",
                  "    // signal to exit route",
                  "    if (err && err === 'route') {",
                  "      return done();",
                  "    }",
                  ""
                ]
              },
              {
                "filename": "[[FILENAME4]]",
                "module": "express.lib.router:route",
                "function": "next",
                "lineno": 149,
                "colno": 13,
                "in_app": false,
                "pre_context": [
                  "    }",
                  "",
                  "    if (layer.method && layer.method !== method) {",
                  "      next(err)",
                  "    } else if (err) {",
                  "      layer.handle_error(err, req, res, next);",
                  "    } else {"
                ],
                "context_line": "      layer.handle_request(req, res, next);",
                "post_context": [
                  "    }",
                  "",
                  "    sync = 0",
                  "  }",
                  "};",
                  "",
                  "/**"
                ]
              },
              {
                "filename": "[[FILENAME3]]",
                "module": "express.lib.router:layer",
                "function": "Layer.handle [as handle_request]",
                "lineno": 95,
                "colno": 5,
                "in_app": false,
                "pre_context": [
                  "",
                  "  if (fn.length > 3) {",
                  "    // not a standard request handler",
                  "    return next();",
                  "  }",
                  "",
                  "  try {"
                ],
                "context_line": "    fn(req, res, next);",
                "post_context": [
                  "  } catch (err) {",
                  "    next(err);",
                  "  }",
                  "};",
                  "",
                  "/**",
                  " * Check if this route matches `path`, if so"
                ]
              },
              {
                "filename": "[[FILENAME5]]",
                "module": "app",
                "function": "?",
                "lineno": 165,
                "colno": 15,
                "in_app": true,
                "pre_context": [
                  "    var randomVariableToRecord = 'LOCAL VARIABLE';",
                  "    throw new Error(\"Uncaught Local Variable Error - \".concat(JSON.stringify({ randomVariableToRecord: randomVariableToRecord })));",
                  "});",
                  "app.get('/test-local-variables-caught', function (req, res) {",
                  "    var randomVariableToRecord = 'LOCAL VARIABLE';",
                  "    var exceptionId;",
                  "    try {"
                ],
                "context_line": "        throw new Error('Local Variable Error');",
                "post_context": [
                  "    }",
                  "    catch (e) {",
                  "        exceptionId = Sentry.captureException(e);",
                  "    }",
                  "    res.send({ exceptionId: exceptionId, randomVariableToRecord: randomVariableToRecord });",
                  "});",
                  "Sentry.setupExpressErrorHandler(app);"
                ],
                "vars": {
                  "exceptionId": "<undefined>",
                  "randomVariableToRecord": "LOCAL VARIABLE",
                  "res": "<ServerResponse>",
                  "req": "<IncomingMessage>"
                }
              }
            ]
          },
          "mechanism": {
            "type": "generic",
            "handled": true
          }
        }
      ]
    },
    "event_id": "[[ID1]]",
    "platform": "node",
    "contexts": {
      "trace": {
        "trace_id": "[[ID2]]",
        "span_id": "[[ID3]]"
      },
      "runtime": {
        "name": "node",
        "version": "v20.12.1"
      },
      "app": {
        "app_start_time": "[[ISODateString]]",
        "app_memory": "[[highNumber]]"
      },
      "os": {
        "kernel_version": "23.2.0",
        "name": "macOS",
        "version": "14.2",
        "build": "23C64"
      },
      "device": {
        "boot_time": "[[ISODateString]]",
        "arch": "arm64",
        "memory_size": "[[highNumber]]",
        "free_memory": "[[highNumber]]",
        "processor_count": 10,
        "cpu_description": "Apple M1 Pro",
        "processor_frequency": "[[highNumber]]"
      },
      "culture": {
        "locale": "en-US",
        "timezone": "Europe/Vienna"
      },
      "cloud_resource": {}
    },
    "server_name": "D9M3PY4LQ7.local",
    "timestamp": "[[timestamp]]",
    "environment": "qa",
    "sdk": {
      "integrations": [
        "InboundFilters",
        "FunctionToString",
        "LinkedErrors",
        "RequestData",
        "Console",
        "Http",
        "NodeFetch",
        "OnUncaughtException",
        "OnUnhandledRejection",
        "ContextLines",
        "LocalVariables",
        "Context",
        "Modules",
        "Express",
        "Fastify",
        "Graphql",
        "Mongo",
        "Mongoose",
        "Mysql",
        "Mysql2",
        "Postgres",
        "Nest",
        "Hapi",
        "Koa"
      ],
      "name": "sentry.javascript.node",
      "version": "8.0.0-alpha.9",
      "packages": [
        {
          "name": "npm:@sentry/node",
          "version": "8.0.0-alpha.9"
        }
      ]
    },
    "breadcrumbs": [
      {
        "timestamp": "[[timestamp]]",
        "category": "console",
        "level": "log",
        "message": "Example app listening on port 3030"
      }
    ],
    "request": {
      "method": "GET",
      "cookies": {},
      "headers": {
        "host": "localhost:3030",
        "user-agent": "[[user-agent]]",
        "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8",
        "accept-language": "en-US,en;q=0.5",
        "accept-encoding": "gzip, deflate, br",
        "connection": "keep-alive",
        "upgrade-insecure-requests": "1",
        "sec-fetch-dest": "document",
        "sec-fetch-mode": "navigate",
        "sec-fetch-site": "none",
        "sec-fetch-user": "?1",
        "pragma": "no-cache",
        "cache-control": "no-cache"
      },
      "url": "http://localhost:3030/test-local-variables-caught"
    },
    "transaction": "GET /test-local-variables-caught",
    "modules": {
      "semver": "7.6.0",
      "yallist": "4.0.0",
      "shimmer": "1.2.1",
      "require-in-the-middle": "7.3.0",
      "resolve": "1.22.8",
      "is-core-module": "2.13.1",
      "hasown": "2.0.2",
      "function-bind": "1.1.2",
      "debug": "4.3.4",
      "supports-color": "5.5.0",
      "module-details-from-path": "1.0.3",
      "import-in-the-middle": "1.7.3",
      "express": "4.19.2",
      "body-parser": "1.20.2",
      "depd": "2.0.0",
      "merge-descriptors": "1.0.1",
      "finalhandler": "1.2.0",
      "encodeurl": "1.0.2",
      "escape-html": "1.0.3",
      "on-finished": "2.4.1",
      "ee-first": "1.1.1",
      "parseurl": "1.3.3",
      "statuses": "2.0.1",
      "unpipe": "1.0.0",
      "array-flatten": "1.1.1",
      "path-to-regexp": "0.1.7",
      "methods": "1.1.2",
      "utils-merge": "1.0.1",
      "setprototypeof": "1.2.0",
      "qs": "6.11.0",
      "side-channel": "1.0.6",
      "get-intrinsic": "1.2.4",
      "es-errors": "1.3.0",
      "has-symbols": "1.0.3",
      "has-proto": "1.0.3",
      "call-bind": "1.0.7",
      "set-function-length": "1.2.2",
      "define-data-property": "1.1.4",
      "es-define-property": "1.0.0",
      "gopd": "1.0.1",
      "has-property-descriptors": "1.0.2",
      "object-inspect": "1.13.1",
      "safe-buffer": "5.2.1",
      "content-disposition": "0.5.4",
      "content-type": "1.0.5",
      "send": "0.18.0",
      "http-errors": "2.0.0",
      "inherits": "2.0.4",
      "toidentifier": "1.0.1",
      "destroy": "1.2.0",
      "etag": "1.8.1",
      "fresh": "0.5.2",
      "mime": "1.6.0",
      "ms": "2.1.3",
      "range-parser": "1.2.1",
      "proxy-addr": "2.0.7",
      "forwarded": "0.2.0",
      "ipaddr.js": "1.9.1",
      "accepts": "1.3.8",
      "negotiator": "0.6.3",
      "mime-types": "2.1.35",
      "mime-db": "1.52.0",
      "type-is": "1.6.18",
      "media-typer": "0.3.0",
      "cookie-signature": "1.0.6",
      "cookie": "0.6.0",
      "vary": "1.1.2",
      "bytes": "3.1.2",
      "raw-body": "2.5.2",
      "iconv-lite": "0.4.24",
      "safer-buffer": "2.1.2",
      "serve-static": "1.15.0",
      "opentelemetry-instrumentation-fetch-node": "1.1.2"
    }
  }
]